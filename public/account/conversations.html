<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Conversations</title>
    <link rel = "icon" href = "../favicon.ico"/>
    <link href="../style.css" rel="stylesheet" type="text/css"/>
    <link href="accountPageStyle.css" rel="stylesheet" type="text/css"/>
  </head>
  <body id = "conversations-page">
    <!--navigation bar-->
    <nav class = "navbar account-topNav scrolledDown">
      <!--company name to display on mobile outside of menu-->
      <span class = "navName nav-backup"><a href = "../index.html">KatKure</a></span>
      
      <!--links-->
      <div class = "navbar-collapse">
        <ul>
          <li><span class = "navName"><a href = "../index.html">KatKure</a></span></li>
          <li><a href = "../index.html">Home</a></li>
          <li><a class = "dropdown-top">About</a>
            <div>
              <ul class = "dropdown">
                <li><a href = "../about.html">Company</a></li>
                <li><a href = "../about-webpage.html">This page</a></li>
              </ul>
            </div>
          </li>
          <li><a class = "dropdown-top">Products</a>
            <div>
              <ul class = "dropdown">
                <li><a href = "../services.html">Platform</a></li>
                <li><a href = "../products.html">Shop</a></li>
                <li><a href = "../cart.html">Cart</a></li>
              </ul>
            </div>
          </li>
          <li><a href = "../news/index.html">News</a></li>
          <li><a href = "../faq.html">FAQs</a></li>
          <li class = "accountLink"><a class = "dropdown-top loggedIn"><i class = "material-icons">account_circle</i>Jane Doe</a>
            <div>
              <ul class = "dropdown">
                <li><a href = "dashboard.html">Dashboard</a></li>
                <li><a href = "../index.html">Log Out</a></li>
              </ul>
            </div>
          </li>
        </ul>
      </div>

      <!--menu icon for mobile display-->
      <i class = "material-icons" id = "navMenu">menu</i>
    </nav>

    <!--side nav with account navigation-->
    <nav class = "sidebar">
      <ul>
        <li><a href = "dashboard.html"><i class = "material-icons">space_dashboard</i><span>Dashboard</span></a></li>
        <li><a href = "appointments.html"><i class = "material-icons">date_range</i><span>Appointments</span></a></li>
        <li class = "nav-active"><a href = "conversations.html"><i class = "material-icons">question_answer</i><span>Conversations</span></a></li>
        <li><a href = "explore.html"><i class = "material-icons">explore</i><span>Explore</span></a></li>
        <li><a href = "settings.html"><i class = "material-icons">manage_accounts</i><span>Account</span></a></li>
        <li><a class = "log-out-button"><i class = "material-icons">logout</i><span>Log out</span></a></li>
      </ul>
    </nav>

    <div class = "account-content" id = "chat-content">
      <!--list of people-->
      <div id = "chat-side">
        <h2>People</h2>
        <div class = "chat-people active">
          <img src = "../media/alina-miller.png"/>
          <div>
            <p class = "chat-name">Alina Miller</p>
            <p>Counselor, LMHC</p>
            <p class = "last-message">Alina: No problem!</p>
          </div>
        </div>
        <div class = "chat-people">
          <img src = "../media/rick-pfp.png"/>
          <div>
            <p class = "chat-name">Group Session</p>
            <p>14 people</p>
            <p class = "last-message">Rick: Okay, sounds good!</p>
          </div>
        </div>
        <div class = "chat-people">
          <img src = "../media/hazel-jones.png"/>
          <div>
            <p class = "chat-name">Hazel Jones</p>
            <p>Counselor, LMHC</p>
            <p class = "last-message">Hazel: I'll always be happy to...</p>
          </div>
        </div>
      </div>

      <!--chat (right side)-->
      <div id = "chat-container">
        <!--conversations-->

        <!--FORMAT, IMPORTANT!
          ALL messages will have the "message" class. If you want to have a quick reply (without the little carrot on the side), make the class "message quickly-after"
          ALWAYS set data-chat-from to either "you" or "other" depending on who the message is from

          Example:
          <div class = "message" data-chat-from = "you">
            <img src = ""/> Image here, only add image if it's not a quick reply
            
            <div class = "chat-text">
              Add text here using <p> tags
            </div>
          </div>

          If you are doing stuff for the group chat and the message is from another person, add the name of the person it's from to the div like this:
          <div class = "message" data-chat-from = "other" data-person = "Luke">...</div>
          This will create a message div with the name "Luke" underneath it. Again, this is only necessary for the group chat (the second conversation)

          If you want to create a time divider, add 
          <div class = "time-divider">
            <span>Month Day 2021</span>
          </div>
        -->

        <!--chat with alina-->
        <div class = "conversation" data-for = "Alina" data-hasscrolled = "false">
          <div class = "conversation-back">
            <p class = "back-button"><i class = "material-icons">navigate_before</i> Back</p>
            <p class = "conversation-name">Alina</p>
          </div>
          <div class = "message" data-chat-from = "other">
            <img src = "../media/alina-miller.png"/>
            <div class = "chat-text">
              <p>Hey Jane!</p>
              <p>I'm Dr. Miller (you can call me Alina) and I will be your assigned counselor and I just want you to know that I'm here for any questions
              or concerns :)</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>Hi Alina! I'm glad to be working with KatKure</p>
            </div>
          </div>
          <div class = "time-divider">
            <span>March 1 2021</span>
          </div>
          <div class = "message" data-chat-from = "other">
            <img src = "../media/alina-miller.png"/>
            <div class = "chat-text">
              <p>So I saw you were interested in our therapy sessions</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other">
            <div class = "chat-text">
              <p>Can I ask what are some of your initial concerns and why you decided to sign up?</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>
                Ofc! Because of the pandemic, I am not able to go to my regular therapy
                sessions and I don’t know what to do, because I am scared of relapsing.
              </p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "you">
            <div class = "chat-text">
              <p>What exactly happens in the therapy sessions and can you walk me through it?</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other">
            <img src = "../media/alina-miller.png"/>
            <div class = "chat-text">
              <p>
                Yes! I hold private sessions as well as a group session called "The Road to Discovery"
              </p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other">
            <div class = "chat-text">
              <p>During private sessions, we focus on YOU and find strategies to fight the struggles you may be facing.
              In our group sessions, we focus on talk-therapy and in creating a communal and safe space where everybody
              can feel comfortable to speak.</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>Great! Thank you, I will most likely want a private session next Friday</p>
            </div>
          </div>

          <div class = "time-divider">
            <span>March 10 2021</span>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>I've been feeling a little stressed lately and am worried it could lead to me wanting to use again</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "you">
            <div class = "chat-text">
              <p>What could you recommend?</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other">
            <img src = "../media/alina-miller.png"/>
            <div class = "chat-text">
              <p>I'm sorry to hear that, but first know that you're doing incredibly well under less-than-ideal circumstances. It's normal to feel stressed from time to time.</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other">
            <div class = "chat-text">
              <p>That being said, maybe you could try taking a walk outside</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other">
            <div class = "chat-text">
              <p>I know it's cliche, but nature really has a powerful way of lifting our mood!</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>I have a park nearby, so I could definitely take a walk there every day!</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other">
            <img src = "../media/alina-miller.png"/>
            <div class = "chat-text">
              <p>That's great!</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other">
            <div class = "chat-text">
              <p>You could also try meditation, which also sounds overused but is really beneficial.</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other">
            <div class = "chat-text">
              <p>As a matter of fact, in a few weeks there'll be a live event for meditation, you could sign up if you're interested.</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>Oh that sounds really cool!</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "you">
            <div class = "chat-text">
              <p>I'll definitely be sure to check that out, thank you for all the tips!</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other">
            <img src = "../media/alina-miller.png"/>
            <div class = "chat-text">
              <p>I'm glad to help!</p>
            </div>
          </div>

          <div class = "time-divider">
            <span>March 16 2021</span>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>Hi Dr. Miller! I have a friend (whose names I will keep confidential) who is
                struggling with depression, which worsened during the pandemic.
              </p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "you">
            <div class = "chat-text">
              <p>You've really helped me a lot so far and I was wondering what I could tell her if she wanted to join a therapy session.</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other">
            <img src = "../media/alina-miller.png"/>
            <div class = "chat-text">
              <p>Everyone is welcome to join KatKure! Would you ask your friend whether a group or individual session is preferred?</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>She seems to prefer a group session.</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other">
            <img src = "../media/alina-miller.png"/>
            <div class = "chat-text">
              <p>In that case, it might help to talk with Dr. Jones, since she is very experienced with group sessions dealing with these things.</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other">
            <div class = "chat-text">
              <p>I feel like the sessions she leads or could recommend would be much more focused on what your friend seems to need :)</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>Okay, thank you so much!</p>
            </div>
          </div>

          <div class = "time-divider">
            <span>March 22 2021</span>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>I had a question...</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "you">
            <div class = "chat-text">
              <p>
                What are some tips to continue staying clean? I have been clean for a while and I’m really
                proud of myself. But with the pandemic, I am afraid of breaking that momentum.
              </p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other">
            <img src = "../media/alina-miller.png"/>
            <div class = "chat-text">
              <p>
                It's great that you're reaching out, and congrats on staying clean for so long!
              </p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other">
            <div class = "chat-text">
              <p>Here are some tips: make sure to have a schedule.</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other">
            <div class = "chat-text">
              <p>If you preoccupy yourself with making sure everything you need to get done is done, of course without overexerting yourself, you can distract the urge to use opiates</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>Okay, that sounds good! Maybe I should get a planner or a calendar app to help me organize my day.</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other">
            <img src = "../media/alina-miller.png"/>
            <div class = "chat-text">
              <p>Yes, those would both be great ways to create and stick to a schedule for yourself!</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other">
            <div class = "chat-text">
              <p>Also, make sure you have a balanced sleep pattern.</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other">
            <div class = "chat-text">
              <p>On a biological level, we need to make sure that our naturally producing melatonin is kicking in to help maintain our circadian rhythm.</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>Wow, I never knew that!</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>I guess sleep is really important to our health in more ways than one</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other">
            <img src = "../media/alina-miller.png"/>
            <div class = "chat-text">
              <p>That's definitely true! :)</p>
            </div>
          </div>

          <div class = "time-divider">
            <span>March 23 2021</span>
          </div>
          <div class = "message" data-chat-from = "other">
            <img src = "../media/alina-miller.png"/>
            <div class = "chat-text">
              <p>Here are a few articles I found that gave some really good tips about staying clean, I hope you will find them helpful!</p>
              <p><a href="https://www.verywellmind.com/tips-for-staying-clean-and-sober-67900" target="_blank">https://www.verywellmind.com/tips-for-staying-clean-and-sober-67900</a></p>
              <p><a href = "https://magnoliarecovery.com/blog/2019/11/21/10-tips-stay-clean-sober" target = "_blank">https://magnoliarecovery.com/blog/2019/11/21/10-tips-stay-clean-sober</a></p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>I'll definitely check them out, thank you!</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other">
            <img src = "../media/alina-miller.png"/>
            <div class = "chat-text">
              <p>No problem!</p>
            </div>
          </div>
        </div>
        
        <!--group chat-->
        <div class = "conversation" data-for = "Group" data-hasscrolled = "false">
          <div class = "conversation-back">
            <p class = "back-button"><i class = "material-icons">navigate_before</i> Back</p>
            <p class = "conversation-name">Recovering From Addiction</p>
          </div>
          <div class = "message" data-chat-from = "other" data-person = "Hazel">
            <img src = "../media/hazel-jones.png"/>
            <div class = "chat-text">
              <p>Hello everybody! I am Dr. Hazel, and I am very excited to help guide you all through a process of healing and therapy! I am a specialist in opiate recovery and treatments and have led closed group sessions for five years, now.</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other" data-person = "Hazel">
            <div class = "chat-text">
              <p>If you all have any questions, please ask me!</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other" data-person = "Sara">
            <img src = "../media/sara-pfp.png"/>
            <div class = "chat-text">
              <p>Hi! I’m Sara and this is my first time joining a group therapy session. I'm looking forward to this!</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>Hi! This is my first time joining group therapy too :)</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other" data-person = "Molly">
            <img src = "../media/molly-pfp.png"/>
            <div class = "chat-text">
              <p>Hey everyone, I'm Molly. This is my third group therapy, and I really recommend it.</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other" data-person = "Sara">
            <img src = "../media/sara-pfp.png"/>
            <div class = "chat-text">
              <p>Thanks, that's good to know!</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other" data-person = "Luke">
            <img src = "../media/luke-pfp.png"/>
            <div class = "chat-text">
              <p>Hey everybody! I'm Luke and I enjoy skateboarding in my free time</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other" data-person = "Luke">
            <div class = "chat-text">
              <p>What about you?</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>I like reading Stephen King novels!</p>
              <p>It can sometimes scare me, but they're so addicting, haha</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other" data-person = "Sara">
            <img src = "../media/sara-pfp.png"/>
            <div class = "chat-text">
              <p>Whoa, me too! I love that we have something in common!</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other" data-person = "Sara">
            <div class = "chat-text">
              <p>Joining KatKure really showed me that I'm not alone in more ways than one</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>Definitely, I feel the same way!</p>
            </div>
          </div>

          <div class = "time-divider">
            <span>March 23 2021</span>
          </div>
          <div class = "message" data-chat-from = "other" data-person = "Rick">
            <img src = "../media/rick-pfp.png"/>
            <div class = "chat-text">
              <p>Hello there! I'm excited to get to know all of you more!</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other" data-person = "Rick">
            <div class = "chat-text">
              <p>The first session is in a couple of days, right?</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>Yup, it's actually tomorrow</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "you">
            <div class = "chat-text">
              <p>I think</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other" data-person = "Hazel">
            <img src = "../media/hazel-jones.png"/>
            <div class = "chat-text">
              <p>Yes, it's tomorrow from 9:00 - 10:00 AM</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other" data-person = "Hazel">
            <div class = "chat-text">
              <p>Looking forward to seeing everybody!</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other" data-person = "Rick">
            <img src = "../media/rick-pfp.png"/>
            <div class = "chat-text">
              <p>Okay, sounds good!</p>
            </div>
          </div>
        </div>

        <!--last chat with hazel-->
        <div class = "conversation" data-for = "Hazel" data-hasscrolled = "false">
          <div class = "conversation-back">
            <p class = "back-button"><i class = "material-icons">navigate_before</i> Back</p>
            <p class = "conversation-name">Hazel</p>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>Hi Dr. Jones! I have a friend who has struggled with depression during the pandemic and would like to join a virtual therapy group session.</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "you">
            <div class = "chat-text">
              <p>I asked my counselor, Dr. Miller, and she told me you would be able to better recommend some groups that could help.</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other">
            <img src = "../media/hazel-jones.png"/>
            <div class = "chat-text">
              <p>Hi Jane! I'm glad your friend is considering therapy at KatKure. There are plenty of groups whose focus is on depression.</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other">
            <div class = "chat-text">
              <p>Dr. Hoo's group "Overcoming Depression" is a great group that I'd recommend, and it has an open spot right now.</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other">
            <div class = "chat-text">
              <p>If your friend wants a smaller group, my close coworker also has an open group called "Healing Minds"</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>Thank you so much!</p>
            </div>
          </div>

          <div class = "time-divider">
            <span>March 17 2021</span>
          </div>
          <div class = "message" data-chat-from = "other">
            <img src = "../media/hazel-jones.png"/>
            <div class = "chat-text">
              <p>I forgot to mention this, but if she would like more info, she is free to create a connection with me!</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other">
            <div class = "chat-text">
              <p>I feel this would be an easier way of communicating</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>Oh yeah I haven't thought about that, thanks!</p>
            </div>
          </div>

          <div class = "time-divider">
            <span>March 19 2021</span>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>Hi, I've been looking into joining a group session myself.</p>
              <p>I saw yours has just opened, and was wondering if you could explain what being a "closed group session" would mean.</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other">
            <img src = "../media/hazel-jones.png"/>
            <div class = "chat-text">
              <p>Of course! A closed group session means that everyone in the group will start at the same time.</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other">
            <div class = "chat-text">
              <p>Because of that, people can't join at any time like they would in an open group.</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other">
            <div class = "chat-text">
              <p>But the advantage is that everyone will be able to get to know each other very well and form close bonds!</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "you">
            <div class = "chat-text">
              <p>Okay, that makes sense, thanks!</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "you">
            <div class = "chat-text">
              <p>It's my first time thinking about doing group therapy, so I'm a little confused on the terminology, haha.</p>
            </div>
          </div>
          <div class = "message" data-chat-from = "other">
            <img src = "../media/hazel-jones.png"/>
            <div class = "chat-text">
              <p>Oh, no worries! If you have any more questions, feel free to ask!</p>
            </div>
          </div>
          <div class = "message quickly-after" data-chat-from = "other">
            <div class = "chat-text">
              <p>I'll always be happy to help :^)</p>
            </div>
          </div>
        </div>

        <!--text box-->
        <form id = "chat-typing-box">
          <input autocomplete = "off" type = "text" id = "chatInput" placeholder = "Message Alina"/>
        </form>
      </div>
    </div>
  </div>
  <script src = "../script.js"></script>
  <script src = "eventTimes.js"></script>
  <script>
    const chatPeopleContainer = document.getElementById("chat-side");
    const chatPeople = document.getElementsByClassName("chat-people");
    const chatConvoContainer = document.getElementById("chat-container");
    const conversations = document.getElementsByClassName("conversation");
    const backButtons = document.getElementsByClassName("back-button");
    const chatInput = document.getElementById("chatInput");
    let activeIndex = 0;
    let prevIndex = 0;
    let isNarrow = getComputedStyle(chatPeopleContainer).position === "relative";

    //setting up person name at the end of messages
    const chatMessages = document.getElementsByClassName("message");
    for(let i = 0; i < conversations.length; i++){
      let chatMessages = conversations[i].querySelectorAll("div.message[data-chat-from = \"other\"]");
      for(let j = 0; j < chatMessages.length; j++){
        if(j === chatMessages.length - 1 || chatMessages[j+1].className.indexOf("quickly-after") === -1){
          let newSpanName = document.createElement("span");
          newSpanName.textContent = i === 1 ? chatMessages[j].dataset.person:conversations[i].dataset.for;
          newSpanName.className = "chat-msg-name";
          chatMessages[j].getElementsByClassName("chat-text")[0].appendChild(newSpanName);
        }
      }
    }

    //setting up time dividers dates (to be relative to the current day)
    const timeDividers = document.getElementsByClassName("time-divider");
    const startToday = new Date(curTime.getTime());
    startToday.setHours(0, 0, 0, 0);
    const refDate = new Date("March 23 2021");
    for(let i = 0; i < timeDividers.length; i++){
      let spanEl = timeDividers[i].getElementsByTagName("span")[0];
      let timeNow = new Date(spanEl.textContent);
      timeNow.setHours(0, 0, 0, 0);
      let numDaysBetween = (refDate.getTime() - timeNow.getTime())/(24 * 60 * 60 * 1000);
      if(numDaysBetween === 0){
        spanEl.textContent = "Today";
      }
      else if(numDaysBetween === 1){
        spanEl.textContent = "Yesterday";
      }
      else {
        let newDate = addDays(startToday, -numDaysBetween);
        spanEl.textContent = createFullMonthStr(newDate);
      }
    }

    //showing chat functions
    function scrollToBottom(el){ //function to scroll to bottom of the chat on first load
      if(el.dataset.hasscrolled === "false"){
        el.scrollTop = el.scrollHeight;
        el.dataset.hasscrolled = "true";
      }
    }
    function handleFadeTransEnd(e){
      //complete transition on fade out
      e.target.style.display = "none";
      e.target.removeEventListener("transitionend", handleFadeTransEnd);

      //fade in active div
      conversations[activeIndex].style.display = "block";
      conversations[activeIndex].style.opacity = "0";
      scrollToBottom(conversations[activeIndex]);
      window.setTimeout(function(){
        conversations[activeIndex].style.opacity = "1";
      }, 10);
    }
    function showChatBoth(index, target){ //common ground for both narrow + wide functions
      prevIndex = activeIndex;
      conversations[prevIndex].style.opacity = "0";
      chatPeople[prevIndex].classList.remove("active");

      activeIndex = index;
      chatPeople[activeIndex].classList.add("active");
      chatInput.placeholder = "Message " + conversations[activeIndex].dataset.for;
    }
    let showChatFuncWide = function(index){
      const ind = index;
      const target = conversations[ind];
      return function(){
        showChatBoth(ind, target);

        //fade out previous div
        conversations[prevIndex].addEventListener("transitionend", handleFadeTransEnd);
      }
    }
    let showChatFuncNarrow = function(index){
      const target = conversations[index];
      const ind = index;
      return function(){
        showChatBoth(ind, target);

        //transitioning
        conversations[prevIndex].style.display = "none";
        chatConvoContainer.style.transform = "translateX(0)";
        target.style.display = "block";
        target.style.opacity = "1";

        //scrolling to bottom
        scrollToBottom(target);
      }
    }

    let handleChatAll = (function(){
      let hasSetUpBack = false;
      let wideChatFuncs = [];
      let narrowChatFuncs = [];
      return function(initial){
        //sliding on smaller width screens
        if(isNarrow){
          for(let i = 0; i < chatPeople.length; i++){
            //adding click functions
            if(!narrowChatFuncs[i]){
              let chatFunc = showChatFuncNarrow(i);
              narrowChatFuncs.push(chatFunc);
            }
            chatPeople[i].addEventListener("click", narrowChatFuncs[i]);

            //removing conflicting wide chat click function
            if(wideChatFuncs[i]){
              chatPeople[i].removeEventListener("click", wideChatFuncs[i]);
            }

            //hiding other conversations initially
            if(initial && i !== activeIndex){
              conversations[i].style.opacity = "0";
              conversations[i].style.display = "none";
            }
          }

          //setting up back buttons
          if(!hasSetUpBack){
            for(let i = 0; i < backButtons.length; i++){
              backButtons[i].addEventListener("click", function(){
                chatConvoContainer.style.transform = "translateX(100%)";
              });
            }
            hasSetUpBack = true;
          }
        }

        //hiding/showing chat on larger screens
        else {
          for(let i = 0; i < chatPeople.length; i++){
            //adding click functions
            if(!wideChatFuncs[i]){
              let chatFunc = showChatFuncWide(i);
              wideChatFuncs.push(chatFunc);
            }
            chatPeople[i].addEventListener("click", wideChatFuncs[i]);

            //removing conflicting narrow chat click function
            if(narrowChatFuncs[i]){
              chatPeople[i].removeEventListener("click", narrowChatFuncs[i]);
            }

            //hiding other conversations initially
            if(initial && i !== activeIndex){
              conversations[i].style.opacity = "0";
              conversations[i].style.display = "none";
            }
          }
        }
      }
    })();
    handleChatAll(true);
    
    //initially scrolling to bottom automatically on the first chat if not narrow
    if(!isNarrow){
      scrollToBottom(conversations[activeIndex]);
    }

    //handling functions on resize
    window.addEventListener("resize", function(){
      //wide to narrow
      if(getComputedStyle(chatPeopleContainer).position === "relative"){
        if(!isNarrow){
          isNarrow = true;
          handleChatAll(false);
        }
      }

      //narrow to wide
      else {
        if(isNarrow){
          isNarrow = false;
          chatConvoContainer.style.transform = "translateX(0)";
          handleChatAll(false);
        }
      }
    });
  </script>
</body>
</html>
